<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mytijian.admin.dao.rbac.dao.RoleMapper">

	<resultMap id="roleMapResult"
		type="com.mytijian.admin.dao.rbac.dataobject.RoleDO">
		<id column="id" property="id" />
		<result column="gmt_created" property="gmtCreated" />
		<result column="gmt_modified" property="gmtModified" />
		<result column="role_name" property="roleName" />
		<result column="description" property="description" />
		<result column="seq" property="seq" />
		<result column="status" property="status" />
	</resultMap>

	<sql id="baseColumns">
		id,
		gmt_created,
		gmt_modified,
		role_name,
		description,
		seq,
		status
	</sql>

	<select id="selectById" parameterType="Integer" resultMap="roleMapResult">
		SELECT
		<include refid="baseColumns" />
		FROM
		tb_role
		where id=#{roleId} and status = 1
	</select>

	<select id="listRoles" resultMap="roleMapResult">
		select
		<include refid="baseColumns" />
		from tb_role
		where status = 1
		<if test="roleName != null and roleName.trim() != ''">
			and `role_name` like concat('%',#{roleName},'%')
		</if>
		order by id asc
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>

	<select id="countTotal" resultType="int">
		select count(*) from tb_role
		where status = 1
		<if test="roleName != null and roleName.trim() != ''">
			and `role_name` like concat('%',#{roleName},'%')
		</if>
	</select>

	<insert id="insert" parameterType="com.mytijian.admin.dao.rbac.dataobject.RoleDO"
		useGeneratedKeys="true" keyProperty="id">
		insert into tb_role
		(
		`gmt_created`,
		`gmt_modified`,
		`role_name`,
		`description`,
		`seq`,
		`status`
		)
		values
		(
		now(),
		now(),
		#{roleName},
		#{description},
		#{seq},
		1
		)
	</insert>

	<update id="update" parameterType="com.mytijian.admin.dao.rbac.dataobject.RoleDO">
		update tb_role set gmt_modified = now()
		<if test="roleName != null">,`role_name` = #{roleName} </if>
		<if test="description != null">,`description` = #{description}</if>
		where id = #{id}
	</update>

	<delete id="deleteBatch">
		update tb_role set gmt_modified= now(), status = 2 where id in
		<foreach collection="list" index="index" item="roleId" open="("
			separator="," close=")">
			#{roleId}
		</foreach>
	</delete>

	<select id="selectRoleByIds" resultMap="roleMapResult">
		SELECT
		<include refid="baseColumns" />
		FROM
		tb_role
		where status = 1 and id in
		<foreach collection="roleIds" index="index" item="roleId"
			open="(" separator="," close=")">
			#{roleId}
		</foreach>
	</select>

</mapper>